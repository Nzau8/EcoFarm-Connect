{% extends 'connect/base.html' %}
{% load static %}

{% block title %}Add Product - Connect{% endblock %}

{% block content %}
<div class="container mt-4">
  <h3>Add a New Product</h3>
  <p>Fill out the details below to list your product in the marketplace.</p>

  <!-- Add Product Form -->
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="form-group mb-3">
      <label for="name">Product Name:</label>
      <input type="text" id="name" name="name" class="form-control" placeholder="Enter product name" required>
    </div>

    <div class="form-group mb-3">
      <label for="description">Description:</label>
      <textarea id="description" name="description" class="form-control" rows="4" placeholder="Write a detailed description" required></textarea>
    </div>

    <div class="form-group mb-3">
      <label for="price">Price (KES):</label>
      <input type="number" id="price" name="price" class="form-control" placeholder="Enter price" step="0.01" required>
    </div>

    <!-- <div class="form-group mb-3">
      <label for="category">Category:</label>
      <select id="category" name="category" class="form-control" //required>
        <option value="">Select a Category</option>
        {% for category in categories %}
        <option value="{{ category.id }}">{{ category.name }}</option>
        {% endfor %}
      </select>
    </div> -->

    <div class="form-group mb-3">
      <label for="tags">Tags (comma-separated):</label>
      <input type="text" id="tags" name="tags" class="form-control" placeholder="e.g., organic, vegetables, fresh">
    </div>

    <div class="form-group mb-3">
      <label for="stock">Stock Quantity:</label>
      <input type="number" id="stock" name="stock" class="form-control" placeholder="Enter available stock" required>
    </div>

    <div class="form-group mb-3">
      <label for="unit">Unit of Measurement:</label>
      <select id="unit" name="unit" class="form-control" required>
        <option value="kg">Kilograms (kg)</option>
        <option value="g">Grams (g)</option>
        <option value="pcs">Pieces (pcs)</option>
        <option value="l">Litres (l)</option>
        <option value="ml">Millilitres (ml)</option>
        <option value="bunch">Bunch</option>
      </select>
    </div>

    <div class="form-group mb-3">
      <label for="location">Product Location:</label>
      <input type="text" id="location" name="location" class="form-control" 
             placeholder="Enter product location" 
             value="{{ request.user.seller.location }}" required>
    </div>

    <div class="form-group mb-3">
      <label for="image">Product Image:</label>
      <input type="file" id="image" name="image" class="form-control" accept="image/*" onchange="previewImage(this);">
      <small class="text-muted">Upload a clear image of your product (max 5MB)</small>
      <div id="imagePreview" class="mt-2" style="display: none;">
          <img id="preview" src="" alt="Image preview" style="max-width: 200px; max-height: 200px;">
      </div>
    </div>

    <div class="form-group mb-3">
      <h5>Delivery Options</h5>
      <div class="form-check mb-2">
          <input type="checkbox" id="delivery_available" name="delivery_available" class="form-check-input">
          <label class="form-check-label" for="delivery_available">
              I will handle delivery myself
              <small class="d-block text-muted">Check this if you want to manage your own deliveries</small>
          </label>
      </div>
      <div class="form-check">
          <input type="checkbox" id="pickup_available" name="pickup_available" class="form-check-input" checked>
          <label class="form-check-label" for="pickup_available">
              Pickup available
              <small class="d-block text-muted">Allow customers to pick up from your location</small>
          </label>
      </div>
    </div>

    <button type="submit" class="btn btn-success">Add Product</button>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
function previewImage(input) {
    const preview = document.getElementById('preview');
    const previewDiv = document.getElementById('imagePreview');
    
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            preview.src = e.target.result;
            previewDiv.style.display = 'block';
        }
        
        reader.readAsDataURL(input.files[0]);
    } else {
        preview.src = '';
        previewDiv.style.display = 'none';
    }
}
</script>
{% endblock %}
